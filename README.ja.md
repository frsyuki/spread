SpreadOSD
=========
SpreadOSD - 分散ストレージシステム


## 概要

SpreadOSDは、画像、音声、動画などの大きなデータを保存するのに適した、分散ストレージシステムです。
高い **拡張性**、**可用性**、**保守性** を持ち、優れた性能を発揮します。

## 拡張性
サーバを追加->容量増加、性能増加。
無停止で拡張可能。アプリケーションには一切影響しない。

## 可用性
レプリケーション。
サーバの故障に耐える->データ保護、アクセス続行。
極めて短いダウンタイムでフェイルオーバー。
データセンタをまたいだレプリケーション。

## 保守性
管理機能。
中央管理が可能。
負荷を可視化する手段を提供。

## データモデル
SpreadOSDのデータモデルは

  data      attributes
  +---------+---------+
  |         |         |
  +---------+---------+
  |         |         |
  +---------+---------+
  |         |         |
  +---------+---------+
  ...



SpreadOSD アーキテクチャ
========================

SpreadOSDは、高い拡張性と可用性を持った分散ストレージシステム。
ここではアーキテクチャについて述べます。

## ノードの種類

SpreadOSDは、次の4種類のサーバから構成されます：

  - **DS (data server)** は、コンテンツをディスク上に保存したりレプリケーションしたりします。
  - **MDS (metadata server)** は、コンテンツのメタデータを保存します。メタデータにはコンテンツがどのDSに保存されているかを示す情報も含まれています。MDSには[Tokyo Tyrant](http://fallabs.com/tokyotyrant/)を使います。
  - **GW (gateway)** は、アプリケーションからの要求を受け取り、適切なDSに中継します。DSはGWの機能も併せ持っているため、DSをGWとして使うこともできます。
  - **CS (config server)** は、クラスタの設定情報を管理します。また、DSの状態を監視し、故障したDSを自動的に切り離します。

                        App     App     App
                         |       |       |  HTTP or MessagePack-RPC
            ----------- GW      GW      GW or DS
           /            /
    +-------------+    |  GWはアプリケーションからDSにリクエストを中継
    | TokyoTyrant |    |
    |      |      |  +----+   +----+   +----+
    | TokyoTyrant |  | DS |   | DS |   | DS |
    |      |      |  |    |   |    |   |    | レプリケーション･セット
    | TokyoTyrant |  | DS |   | DS |   | DS | 同じレプリケーション･セット内のDSは同じデータを保存
    +-------------+  |    |   |    |   |    |
    MDS              | DS |   | DS |   | DS | ... レプリケーションセットはいつでも追加可能
    メタデータを保存 +----+   +----+   +----+
                         \       |       /
                          -----  |  ----- CSはクラスタの設定情報を管理
                               \ | /
                                CS


## 操作

### データの保存

図

### データの取得

図

### メタデータの保存と取得

図

詳しくは->へ。


## 管理

CSで集中管理
CSから他のノードに自動通知

図

管理ツール
詳しくは->へ。




SpreadOSD インストール
======================

SpreadOSDは Ruby で実装された分散ストレージシステムです。
通常通りmake installでインストールするか、RubyGemsを使ってインストールすることができます。


## 依存ライブラリ

SpreadOSDを実行するには次のソフトウェアが必要です：



## 方法1：RubyGemsを使ったインストール


## 方法2：make installを使ったインストール



-> システム構築へ。


## フルインストールガイド



SpreadOSD システムの構築
========================

ここではSpreadOSDシステムを構築する方法について述べます。

## 1台のホスト上で動かす


## クラスタ構成

以下の例では、次のような6台のノードからなるクラスタを構成します：

図

まずCSを起動。


次にMDSを起動。


そしてDSを起動。

GWを起動。これはオプショナル。


## サーバを追加する



SpreadOSD 運用
==============

## DSの追加

## 重みの設定

## DSの離脱

## 負荷の監視


## スナップショット

スナップショットとは


## ロケーション

ロケーションとは

詳しくは->HowTo


## バックアップ

### バックアップするべき項目

### クラスタ情報のバックアップ

### データのバックアップ

### メタデータのバックアップ




SpreadOSD 障害対応
==================


## DSの復旧

### データが失われていない場合

### データが失われた場合


## CSの復旧

### データが失われていない場合

### データが失われた場合


## GWの復旧



SpreadOSD コマンドラインリファレンス
====================================



SpreadOSD API
=============

## HTTP API


## MessagePack-RPC API




SpreadOSD 開発とデバッグ
========================




SpreadOSD HowTo: X-Accel-Redirectと組み合わせたシステム構築
===========================================================


SpreadOSD HowTo: メタデータサーバの冗長化
=========================================


SpreadOSD HowTo: データセンタをまたいだレプリケーション
=======================================================


SpreadOSD HowTo: データセンタをまたいだレプリケーション
=======================================================




